\documentclass[12pt]{article}
\usepackage[a4paper, margin=1in]{geometry}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\captionsetup[figure]{name=Слика}
\usepackage[serbian]{babel}
\addto\captionsserbian{
  \renewcommand{\refname}{Литература}
}
\addto\captionsserbian{
    \renewcommand\contentsname{Садржај}
}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}

\sloppy

\begin{document}

\bibliographystyle{plain} 


\begin{center}
    \large\textbf{Математички факултет} \\
    \large\textbf{Универзитет у Београду}
    
    \vspace{3cm}
    
    \Large\textbf{Семинарски рад} \\
    \large У оквиру курса Истраживање података 2
    
    \vspace{3cm}
    
    \LARGE\textbf{Тема:} \\
    \Large Истраживање образаца у патогеним острвима секвенци \textit{Escherichia coli} и \textit{Helicobacter pylori}
    
    \vspace{4cm}
    
    \begin{minipage}{0.4\textwidth}
        \begin{flushleft}
            \large\textbf{Професор:} \\
            \large Ненад Митић
        \end{flushleft}
    \end{minipage}
    \begin{minipage}{0.4\textwidth}
        \begin{flushright}
            \large\textbf{Студенти:} \\
            \large Вељко Продан, 163/2019 \\
            \large Маја Миленковић, 160/2019
        \end{flushright}
    \end{minipage}

    \vfill
    
    \large\textbf{Мај 2024}
    
\end{center}

\newpage

\tableofcontents

\newpage

\section{Увод}

\subsection{Патогена острва}

Патогена острва (\textit{Pathogenicity island} - PAI) су посебни генетски елементи присутни на хромозомима великог броја бактеријских патогена. PAI кодирају различите факторе вируленције и обично су одсутни код непатогених сојева исте или блиско сродних врста. Сматрају се подкласом геномских острва која се стичу хоризонталним преносом гена путем трансдукције, конјугације и трансформације, и пружају "квантне скокове" у микробној еволуцији, што доприноси способности микроорганизама да еволуирају \cite{Gal-Mor2006-dv}. 

\begin{figure}[htbp]
    \centering
    \vspace{0.2cm}
    \includegraphics[width=0.6\linewidth]{images/paidb.png}
    \caption{Графички приказ острва унутар генома}
    \vspace{0.5cm}
    \label{fig:islands}
\end{figure}

Једна бактеријска врста може имати више од једног PAI сегмента. PAI сегменти су кластери гена уграђени у геном патогених организама, хромозомално или екстрахромозомално. PAI могу варирати од 10-200 кб. Они носе гене који им омогућавају да производе различите факторе вируленције, укључујући адхезине, токсине, системе секреције и друге елементе који им помажу да се вежу за ћелије домаћина, избегну имуни систем и изазову болест \cite{Schmidt2004-xj}. Подаци засновани на бројним секвенцираним бактеријским геномима показују да су PAI присутни у широком спектру грам-позитивних и грам-негативних бактеријских патогена људи, животиња и биљака. Недавна истраживања усмерена на PAI довела су до идентификације многих нових фактора вируленције које ове врсте користе током инфекције својих домаћина \cite{Gal-Mor2006-dv}.

Осим PAI, бавићемо се и nPAI и cPAI регионима. ``Регион попут PAI'' се односи на регију у геному која одговара познатим PAI регионима, и садржи барем један хомолог гена вируленције из PAI региона. Ако се овакав регион преклапа са геномским острвом, зовемо га кандидатом за PAI (cPAI), а у супротном се означава као nPAI (non-probable PAI) \cite{Yoon2014-xa}.

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.8\linewidth]{images/pai_grafik.jpg}
    \caption{Процедура одређивања типа региона \cite{Yoon2014-xa}}
\end{figure}

\newpage

\subsection{Ешерихија коли}

Ешерихија коли (Escherichia coli) је разноврсна бактеријска врста која обухвата како безопасне коменсалне сојеве, тако и патогене сојеве који се налазе у гастроинтестиналном тракту људи и топлокрвних животиња. Патогеност Ешерихије коли, која се постиже хоризонталним трансфером гена који одређују факторе вируленције, омогућава овој бактерији да постане врло разноврстан и адаптибилан патоген одговоран за цревне или ванцревне болести код људи и животиња. Сходно томе, сојеви Е. коли могу се класификовати у три групе: коменсалне/пробиотске сојеве, интестинално патогене сојеве и екстраинтестинално патогене сојеве.

Растућа количина информација о ДНК секвенцама, генерисаних у "ери геномике", помогла је у повећању разумевања фактора и механизама укључених у диверзификацију ове бактеријске врсте \cite{Desvaux2020-mx}. 

\subsection{Хеликобактер пилори}

Хеликобактер пилори је грам-негативни патоген спиралног облика који насељава антрум и корпус желуца. У последњој деценији, идентификовани су бројни фактори вируленције. Ови елементи омогућавају бактерији да преживи у изузетно киселој средини гастроинтестиналног тракта, доспе до неутралније средине слузног слоја и одупре се имунолошком одговору човека, што резултује трајним задржавањем инфекције \cite{2022helicobacter}.

Сојеви Хеликобактер пилори показују висок степен генетске хетерогености због геномских преуређења, тачкастих мутација, убацивања и/или брисања гена. Генетички јединствене варијанте једног соја присутне су у желуцима сваког човека, а генетски састав ових популација може се мењати током времена. Ова адаптабилност доприноси и њеној високој заразности \cite{Noto2012-rr}.

Већина инфекција се јавља у детињству, а само мали проценат инфекција напредује до тежих стања. Инфекција овом бактеријом може изазвати различите гастроинтестиналне проблеме, укључујући хронични гастритис, чир на дванаестопалачном цреву, па чак и рак \cite{2022helicobacter}.

\section{Алгоритми истраживања образаца}

\subsection{TF-IDF}

TF-IDF \cite{Liu2018-oa} (Term Frequency - Inverse Document Frequency) алгоритам
 је
статистички метод који се користи за процену важности речи
за документ или категорију у скупу датотека или корпусу. 

Главна идеја је да ако се нека реч или фраза често појављује у
чланку, а ретко се налази у другим члaнцима, сматра се
да реч или фраза има добру способност разликовања класе
и погодна је за класификацију. То је најчешће коришћена
функција за израчунавање тежине речи у тренутном
векторском моделу простора. Углавном се састоји од
два дела, а то су учесталост речи и инверзна учесталост
датотеке. Учесталост речи се односи на број појављивања
дате речи у датотеци. Инверзна учесталост датотеке представља
меру опште важности речи. Инверзна учесталост речи се рачуна деобом
укупног броја докумената са бројем
докумената који садрже тај термин, а затим се логаритмује
резултат количника. Формуле за учесталост речи (TF) и
инверзну учесталост текста (IDF) су следеће:
$$\mathrm{tf}_{i,j} = \frac{n_{i,j}}{\sum_{k} n_{k,j}}$$

$n_{i,j}$  је број појављивања речи $t_{i}$ у датотеци $d_{j}$,
$\sum_{k} n_{k,j}$ је збир појављивања свих речи у датотеци
$d_{j}$.

$$\mathrm{idf}_i = \log \left(\frac{|D|}{|\{j : t_i \in d_j\}|}\right) $$

$|D|$ је укупан број датотека у корпусу, $|\{j : t_i \in d_j\}|$
је број докумената који садрже реч $t_{i}$. Ако
речи нема у корпусу, то ће довести до деобе са нулом. Зато се
уопштено користи 1+$|\{j : t_i \in d_j\}|$.

$$\mathrm{tfidf}_{i,j} = \frac{\mathrm{tf}_{i,j} \times \mathrm{idf}_{i}}{\sqrt{\sum_{t_i \in d_j} \left[\mathrm{tf}_{i,j} \times \mathrm{idf}_i\right]^2}}$$


$\mathrm{tfidf}_{i,j}$ је тежина речи ${t}_{i}$. Може се видети да висока
учесталост речи у одређеној датотеци и ниска учесталост датотеке
речи у целом скупу датотека могу генерисати високу TF-IDF вредност. 

\subsection{NOSEP}

NOSEP \cite{8053457} (Nonoverlapping Sequence Pattern Mining With Gap Constraints) представља исцрпан алгоритам за рударење образаца секвенци који користи Nettree структуру података. Ова структура омогућава прецизно израчунавање учесталости појављивања одређеног обрасца унутар дате секвенце, узимајући у обзир услов непреклапања. 

Приликом рударења образаца секвенци, два главна фактора која утичу на перформансе су израчунавање подршке и смањење простора кандидата образаца. 

За израчунавање подршке, користи се NETGAP алгоритам. NETGAP треба да  разликује знакове у секвенци који се могу поново користити за упаривање образаца, да би се испунио услов непреклапања. Овај изазов се односи на немогућност једноставне замене одговарајућих знакова у секвенци знаком "X", јер би то спречило проналажење будућих непреклапајућих појава. Стога, NETGAP мора ефикасно разликовати знакове који се могу поново користити.

Да би се превазишао наведени проблем и имплементирао алгоритам без претраге уназад, предлаже се коришћење Nettree структуре података. Nettree се конструише на основу обрасца и секвенце, а затим се итеративно проналазе минималне путање које представљају појаве обрасца. После сваке итерације, минимална путања и неважећи чворови се уклањају из дрвета. Овај процес се понавља док дрво не постане празно, гарантујући проналажење свих појава обрасца.

\begin{figure}[h]
    \centering
    \vspace{0.2cm}
    \includegraphics[width=0.6\linewidth]{images/nettree.png}
    \caption{Приказ структуре Nettree}
    \vspace{0.2cm}
    \label{fig:nettree}
\end{figure}

Са друге стране, NOSEP алгоритам користи приступ раста образаца за смањење простора кандидата образаца, који се показао ефикаснијим од приступа претраге у ширину и дубину. NOSEP поседује Apriori својство, што имплицира да ако подобразац није фреквентан, његов надобразац такође не може бити фреквентан. Захваљујући овом својству, простор кандидата образаца се ефикасно редукује.

NOSEP започиње рад проналажењем свих честих узорака дужине 1, а затим итеративно генерише кандидатске узорке растуће дужине комбиновањем честих узорака краћих дужина. За сваки кандидатски узорак, његова подршка се израчунава коришћењем NETGAP алгоритма и Nettree структуре података. Кандидати чија подршка задовољава минимални праг се додају у скуп честих узорака за ту дужину. Овај процес се наставља док се не може пронаћи више честих узорака. На крају, NOSEP враћа унију свих пронађених честих узорака свих дужина, ефикасно рударећи комплетан скуп честих секвенцијалних образаца.

\section{Улазни подаци}

Датотеке са геномским секвенцама, и информације о локацијама острва у тим секвенцама, прикупљени су са веб стране \textit{paidb.re.kr} \cite{Yoon2014-xa}. Геномске секвенце су чуване у FASTA формату, док су индекси почетака и крајева острва чувани у датотекама са одговарајућим суфиксима: \textit{.pai}, \textit{.cpai}, и \textit{.npai}. Број прикупљених генома Ешерихије коли је 90, а генома Хеликобактер пилори је 53.

Сви улазни и излазни подаци за Ешерихију коли се налазе у директоријуму \textit{e\_coli}, док се подаци за Хеликобактер пилори налазе у директоријуму \textit{h\_pylori}. Улазни подаци се налазе унутар директоријума \textit{e\_coli\_data} и \textit{h\_pylori\_data}. FASTA датотеке, као и датотеке са индексима острва за сваки геном се налазе у одговарајућим директоријумима именованим по називу генома. 

\section{Припрема података}

FASTA датотеке су учитаване коришћењем библиотеке \textit{Biopython} \cite{cock2009biopython}, и секвенце су заједно са индексима острва чуване у Python речнику. За потребе TF-IDF алгоритма, секвенце су конвертоване у ниске. \\

NOSEP алгоритам је покретан помоћу библиотеке \textit{SPMF} \cite{fournierviger2016spmf}, која је имплементирана у програмском језику Java, али је позивана помоћу Python библиотеке \textit{spmf-py} \cite{spmf-py}. За употребу \textit{SPMF} библиотеке потребно је кодирати секвенце у одређени формат. Улазна секвенца симбола се прво кодира у низ позитивних целих бројева, где сваки број представља одређени симбол. Поред тога, користе се и специјални симболи за раздвајање карактера (-1) и означавање краја секвенце.

На пример, ако имамо следећу секвенцу:
$$ A\,  A\, G\, T\, A\, C\, G\, A\, C\, G\, C\, A\, T\, C\, T\, A  $$
где су симболи кодирани као:
$$ 1 = A,\, 3 = C,\, 7 = G,\, 20 = T $$
добија се следећа кодирана секвенца:
$$ 1\, -1\, 1\, -1\, 7\, -1\, 20\, -1\, 1\, -1\, 3\, -1\, 7\, -1\, 1\, -1\, 3\, -1\, 7\, -1\, 3\, -1\, 1\, -1\, 20\, -1\, 3\, -1\, 20\, -1\, 1\, -1\, -2\, $$


\section{Примена алгоритама}

\subsection{TF-IDF}
Алгоритам TF-IDF је коришћен помоћу Python библиотеке \textit{scikit-learn} \cite{scikit-learn}, са подразумеваним параметрима. Тражени су обрасци унутар сваког генома, тако да могу да се налазе унутар било којег острва генома, али не и ван њега. Такође су тражени и обрасци који се налазе само делимично унутар неког острва. Минимална дужина образаца који се траже је 4. Максимална дужина тражених образаца за геноме Ешерихије коли је 100, а за геноме Хеликобактер пилори је 50.

Приликом претраге одређених образаца унутар геномске секвенце, узети су у обзир и обрасци који садрже уметања и брисања појединих карактера. Ово је постигнуто коришћењем \textit{pairwise2} модула из библиотеке \textit{Biopython} \cite{cock2009biopython}, који користи алгоритам динамичког програмирања за поравнање секвенци.

\subsection{NOSEP}

Улаз NOSEP алгоритма је кодирана секвенца карактера и пет параметара:
\begin{enumerate}
 \item минимално ограничење дужине (\textit{minlen})
 \item максимално ограничење дужине (\textit{maxlen})
 \item минимално ограничење празнине (\textit{mingap})
 \item максимално ограничење празнине (\textit{maxgap})
 \item задати праг минималне подршке (\textit{minsup})\\
\end{enumerate}

Вредности наведених параметара су биле постављене на следећи начин: минимална дужина 4, максимална дужина 100 за геноме Ешерихије коли и 50 за геноме Хеликобактер пилори, минимална празнина 0, максимална празнина 0 и праг минималне подршке 2.

NOSEP је потом покренут над свим геномима и њиховим острвима ради проналажења образаца у оквиру острва који се не налазе ван острва. Међутим, да би се осигурало да пронађени обрасци буду јединствени за острва, уклоњени су они обрасци који су били присутни и ван острва, у свим осталим геномима. Због дугачког времена извршавања овог алгоритма, у неким острвима већих дужина нису претраживани обрасци.

Приликом претраге одређених образаца унутар генома, као и код алгоритма TF-IDF, коришћен је \textit{pairwise2} модул из библиотеке Biopython.


\section{Излазни подаци}

Током извршавања алгоритама, обрасци су чувани у текстуалним датотекама, и у датотекама JSON формата. Текстуалне датотеке се налазе у директоријумима под називом \textit{patterns}, унутар одговарајућег директоријума за сваки геном, у ком се налазе и улазни подаци. JSON датотеке се налазе унутар директоријума \textit{json}, у почетним \textit{e\_coli} и \textit{h\_pylori} директоријумима. У случају да нема пронађених образаца, одговарајућа текстуална датотека ће да буде празна. \\

Након примене алгоритама, сви нађени обрасци су сачувани унутар Python речника, где се сваки образац слика у низ генома у којима је нађен, геноми се сликају у низ острва у којима се образац налази, док се острва сликају у број појављивања обрасца у том острву.

Речник је на крају филтриран тако да у њему остану сачувани искључиво обрасци који се не налазе ван острва било ког од низа генома. Број нађених образаца генома Ешерихије коли је 89333, а генома Хеликобактер пилори 21042. Ови обрасци су затим сачувани у табелама \textit{csv} формата, где се обрасци налазе у првој колони, имена генома у заглављима осталих колона, док се у ћелијама налази тип острва тог генома (PAI, cPAI, nPAI) уз одговарајући редни број острва и број појављивања обрасца у том острву. Табеле су сачуване у директоријумима назива \textit{csv}, у почетним \textit{e\_coli} и \textit{h\_pylori} директоријумима.

\newpage

\section{Анализа резултата}
\subsection{Ешерихија коли}

Међу нађеним јединственим обрасцима за острва Ешерихије коли, образац појављиван у највише генома налази се у 24 од 90 генома.

\begin{figure}[htbp]
    \centering
    \vspace{0.2cm}
    \includegraphics[width=\linewidth]{images/e_coli/top_10_hist.png}
    \caption{График 10 најчешћих образаца по броју генома \textit{Escherichia coli}}
    \vspace{0.5cm}
    \label{fig:top10hist}
\end{figure}

Међу најчешће појављиваним обрасцима за острва Ешерихије коли, већина образаца се налази у cPAI сегментима.

\begin{figure}[htbp]
    \centering
        \vspace{0.2cm}
    \begin{subfigure}{0.49\linewidth}
        \centering
        \includegraphics[width=\linewidth]{images/e_coli/first_by_islands.png}
    \end{subfigure}
    \begin{subfigure}{0.49\linewidth}
        \centering
        \includegraphics[width=\linewidth]{images/e_coli/second_by_islands.png}
    \end{subfigure}
    \caption{Проценат појављивања два најчешћа обрасца по типу острва \textit{Escherichia coli}}
\end{figure}

\newpage

На следећем графику приказани су обрасци са највећом сумом броја појављивања у геномима, у односу на укупну величину острва унутар тих генома.

\begin{figure}[htbp]
    \centering
    \vspace{0.3cm}
    \includegraphics[width=\linewidth]{images/e_coli/top10_normalized.png}
    \caption{График 10 најчешћих образаца по нормализованом броју појављивања \textit{Escherichia coli}}
    \vspace{0.5cm}
    \label{fig:top10hist}
\end{figure}

Образац који се појављује искључиво у cPAI сегментима са највише појављивања се налази у 13 од 90 генома Ешерихије коли. Најчешћи образац јединствен за nPAI сегменте се појављује у 17 генома.  Није пронађен ни један образац јединствен за PAI тип острва.

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.8\linewidth]{images/e_coli/top15_cpai.png}
    \caption{Најчешћи обрасци јединствени за cPAI сегменте \textit{Escherichia coli}}
    \label{fig:top15_cpai}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.8\linewidth]{images/e_coli/top15_npai.png}
    \caption{Најчешћи обрасци јединствени за nPAI сегменте \textit{Escherichia coli}}
    \label{fig:top15_npai}
\end{figure}

\clearpage

\subsection{Хеликобактер пилори}

Међу нађеним јединственим обрасцима за острва Хеликобактер пилори, образац појављиван у највише генома налази се у 17 од 53 генома.

\begin{figure}[htbp]
    \centering
    \vspace{0.2cm}
    \includegraphics[width=\linewidth]{images/h_pylori/top_10_hist.png}
    \caption{График 10 најчешћих секвенци \textit{Helicobacter pylori}}
    \label{fig:top10histhpylori}
    \vspace{0.5cm}
\end{figure}

Два најчешћа обрасца се већином налазе у nPAI сегментима.

\begin{figure}[htbp]
    \vspace{0.2cm}
    \centering
    \begin{subfigure}{0.41\linewidth}
        \centering
        \includegraphics[width=\linewidth]{images/h_pylori/first_by_islands.png}
    \end{subfigure}
    \begin{subfigure}{0.41\linewidth}
        \centering
        \includegraphics[width=\linewidth]{images/h_pylori/second_by_islands.png}
    \end{subfigure}
    \caption{Проценат појављивања два најчешћа обрасца по типу острва \textit{Helicobacter pylori}}
    \vspace{0.5cm}
\end{figure}

\newpage

На следећем графику приказани су обрасци са највећом сумом броја појављивања у геномима, у односу на укупну величину острва унутар тих генома.

\begin{figure}[htbp]
    \centering
    \vspace{0.2cm}
    \includegraphics[width=\linewidth]{images/h_pylori/top10_normalized.png}
    \caption{График 10 најчешћих образаца по нормализованом броју појављивања}
    \vspace{0.5cm}
    \label{fig:top10histhpylori}
\end{figure}

Образац који се појављује искључиво у cPAI сегментима са највише појављивања се налази у 4 од 53 генома Хеликобактер пилори. Најчешћи образац јединствен за nPAI сегменте, и најчешћи образац јединствен за PAI сегменте се појављују у 3 генома.


\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\linewidth]{images/h_pylori/top15_cpai.png}
    \caption{Најчешћи обрасци јединствени за cPAI сегменте \textit{Helicobacter pylori}}
    \label{fig:top15_cpai}
\end{figure}

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\linewidth]{images/h_pylori/top15_npai.png}
    \caption{Најчешћи обрасци јединствени за nPAI сегменте \textit{Helicobacter pylori}}
    \label{fig:top15_npai}
\end{figure}

\clearpage

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.8\linewidth]{images/h_pylori/top15_pai.png}
    \caption{Најчешћи обрасци јединствени за PAI сегменте \textit{Helicobacter pylori}}
    \vspace{0.5cm}
    \label{fig:top15_pai}
\end{figure}

Није пронађен ни један образац који се појављује и у острвима Ешерихије коли, и острвима Хеликобактер пилори.

\clearpage
\newpage
\bibliography{seminarski}

\end{document}